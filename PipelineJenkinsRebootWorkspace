pipeline {
    agent any
    
    parameters {
        string(name: 'USER_INPUT', defaultValue: '', description: 'Digite o login do usu치rio:')
    }
    
    stages {
        stage('Reiniciar Workspace') {
            steps {
                script {
                    def userInput = params.USER_INPUT
                    
                    // Pesquisar a Workspace associada ao usu치rio
                    def workspaceId = sh(script: "aws workspaces describe-workspaces --query \"Workspaces[?UserName=='${userInput}'].WorkspaceId\" --output text", returnStdout: true).trim()
                    
                    // Reiniciar a Workspace se encontrada
                    if (workspaceId) {
                        sh "aws workspaces reboot-workspaces --reboot-workspace-requests ${workspaceId}"
                        echo "Workspace reiniciada com sucesso para o usu치rio '${userInput}'."
                    } else {
                        echo "Nenhuma Workspace encontrada para o usu치rio '${userInput}'."
                    }
                }
            }
        }
    }
}
